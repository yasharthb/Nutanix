<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" type="image/jpg" href="Images/logo.jpg">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="./../style/new.css">
<link rel="stylesheet" type="text/css" href="../style/main.css">
<link rel="stylesheet" type="text/css" href="../style/table.css">
<link rel="stylesheet" type="text/css" href="../js/pdfgen.js">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
</head>

<body>
<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="/tstamp">Time-Stamp</a>
  <a href="/lsearch" class="active">Log-Search</a>
  <a href="/llogs">Live-Logs</a>
</div>

<div class="topnav" id="myTopnav">
  <a href="/">
    <img src="/Images/logo.jpg" style="width: 35px;margin-left: 10px;">
  </a>
  <div id="imp">
  <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#video" style="background-color: #82E0AA;">
    <i class="fa fa-youtube-play" aria-hidden="true" style="color: white;margin-top: 8px;margin-right: 10px;font-size: 25px;"></i>
  </button>
  </div>
</div>

<div id="main">
  <span style="font-size:20px;cursor:pointer;margin-left: 19px;" onclick="openNav()">&#9776;</span>

  <div class="container">
    <div class="col-md-12">
      <center>
        <h1>Time-Stamp-Search</h1>
        <form method="POST" action="/tstamp">
          <table>
            <tr>
              <td style="text-align: center;font-size: 20px;">
                From:
              </td>
              <td>
                <input type="text" placeholder="2019-03-03 15:56:20.697045" name="datetime1" style="color: black;border:none;border-radius: 0 10px 0 10px;font-size: 20px;padding: 5px;">
              </td>
              <td style="text-align: center;font-size: 20px;">
                To:
              </td>
              <td>
                <input type="text" placeholder="2019-03-03 15:56:27.180213" name="datetime2" style="color: black;border:none;border-radius: 0 10px 0 10px;font-size: 20px;padding: 5px;">
              </td>
              <td>
                <button type="submit" style="background-color: #58D68D;color: white;border:none;border-radius: 10px;font-size: 20px;padding-left: 10px;padding-right: 10px;padding-top: 5px;padding-bottom: 5px;float: left;"><i class="fa fa-search" aria-hidden="true"></i></button>
                </form>
                <button class="btn" id="export" style="background-color: #E74C3C;color: white;border:none;border-radius: 10px;font-size: 20px;padding-left: 10px;padding-right: 10px;padding-top: 5px;padding-bottom: 5px;float: right;"><i class="fa fa-download" aria-hidden="true"></i></button>
              </td>
            </tr>
          </table>
      </center>
    </div>
    <div class="col-md-12" style="margin-top: 10px;" >
      <b>
      <table class="head" style="width: 98.2%;background-color: transparent;">
          <thead>
            <tr>
                <td style="width: 20.1%;text-align: center;background-color: #D5DBDB;color: black;">S.No.</td>
                <!--<td>Time-Stamp</td>-->
                <td style="text-align: center;background-color: #E5E7E9;color: black;">Logs</td>
            </tr>
          </thead>
        </table>
      </b>
      <div id="views">
      <% if(search_results2){ %>
      <% for (var i = 0; i < search_results2.length; i++) { %>
        <table class="inner_table" style="width: 100%;" id="content">
        <tbody>
          <tr>
            <td style="color: black;text-align: center;width: 20%;background-color: #E5E7E9;"><%= i + 1 %></td>
            <td style="color: black;text-align: center;background-color: #F2F3F4;"><%= search_results2[i] %></td>
          </tr>
        </tbody>
        </table>
      <% } %>
      <% } %>
    </div>
    </div>

    <div id="views1" style="display: none;">
      <% if(search_results2){ %>
      <% for (var i = 0; i < search_results2.length; i++) { %>
            <p><%= search_results2[i] %></p>
      <% } %>
      <% } %>
    </div>



<footer id="footer">
   <div class="footer-bottom text-center">
    Copyright &copy; 2019 Log-Analyser
  </div>
</footer>

<style>
  #footer {
    position: fixed;
    bottom: 0px;
    left: 0px;
    right: 0px;
    margin-bottom: 0px;
  }
</style>

<script>
function openNav() {
    document.getElementById("mySidenav").style.width = "250px";
    document.getElementById("main").style.marginLeft = "250px";
    document.body.style.backgroundColor = "#D6EAF8";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("main").style.marginLeft= "0";
    document.body.style.backgroundColor = "#5DADE2";
}
document.getElementById('export').addEventListener('click',
  exportPDF);

var specialElementHandlers = {
  // element with id of "bypass" - jQuery style selector
  '.no-export': function(element, renderer) {
    // true = "handled elsewhere, bypass text extraction"
    return true;
  }
};

function exportPDF() {

  var doc = new jsPDF('p', 'pt', 'a4');
  //A4 - 595x842 pts
  //https://www.gnu.org/software/gv/manual/html_node/Paper-Keywords-and-paper-size-in-points.html


  //Html source 
  var source = document.getElementById('views1').innerHTML;

  var margins = {
    top: 0,
    bottom: 0,
    left: 10,
    width: 595
  };

  doc.fromHTML(
    source, // HTML string or DOM elem ref.
    margins.left,
    margins.top, {
      'width': margins.width,
      // 'elementHandlers': specialElementHandlers
    },

    function(dispose) {
      // dispose: object with X, Y of the last line add to the PDF 
      //          this allow the insertion of new lines after html
      doc.save('Test.pdf');
    }, margins);
}
</script>
     
</body>
</html> 

<!-- modal for video -->

<style>
.modal {
  text-align: center;
}

@media screen and (min-width: 768px) { 
  .modal:before {
    display: inline-block;
    vertical-align: middle;
    content: " ";
    height: 90%;
  }
}

.modal-dialog {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
</style>

<div id="video" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-body" style="background:linear-gradient(to right, #AF7AC5 , #F4D03F);">
        <center>
          <iframe width="600" height="330" src="https://www.youtube.com/embed/lR_NoIh1RB4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </center>
      </div>
    </div>